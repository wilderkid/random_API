# 轮询功能测试指南

## 测试环境准备

1. 启动后端服务：
```bash
cd backend
node server.js
```

2. 启动前端服务：
```bash
cd frontend
npm run dev
```

## 测试步骤

### 1. 配置API提供商
- 访问 `/settings/apis` 页面
- 添加至少2个API提供商，确保它们有相同的模型（如gpt-4）
- 测试连接确保配置正确

### 2. 配置轮询设置
- 访问 `/settings/polling` 页面
- 检查可用池是否正确显示重复模型（只显示有多个提供商的模型）
- 测试拖拽排序功能
- 测试将模型移动到排除池
- 测试将模型从排除池移回可用池

### 3. 测试轮询调用
- 访问主聊天页面 `/`
- 开启轮询模式开关
- 选择一个有多个提供商的模型
- 发送消息，观察是否按配置的顺序轮询

### 4. 测试禁用机制
- 故意配置错误的API密钥或URL
- 连续发送3次请求让提供商失败
- 检查提供商是否被自动禁用
- 在轮询配置页面的禁用状态栏查看被禁用的提供商
- 测试重新启用功能

### 5. 测试排除池功能
- 将某个模型移动到排除池
- 尝试轮询该模型，应该提示没有可用提供商

## 预期结果

1. **重复模型统计**：只有拥有多个提供商的模型才会出现在可用池中
2. **排除池**：被排除的模型不参与轮询
3. **禁用状态栏**：显示因连续失败被禁用的提供商，可以手动重新启用
4. **轮询顺序**：按照用户在可用池中设置的顺序进行轮询
5. **错误处理**：当所有提供商都失败时，显示详细错误信息

## 启动命令

Windows系统启动命令：
```cmd
# 启动后端
cd backend && node server.js

# 启动前端（新开命令行窗口）
cd frontend && npm run dev