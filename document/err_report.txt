PS F:\mysite\equal_ask\backend> npm start

> random-api-backend@1.0.0 start
> node server.js

Server running on http://localhost:3000
OpenAI compatible API available at http://localhost:3000/v1
[DEBUG] ===== NEW CHAT COMPLETION REQUEST =====
[DEBUG] Request model: gpt-oss-120b
[DEBUG] Request stream: true
[DEBUG] Request messages count: 2
[DEBUG] Request parameters: {
  "temperature": 0.4,
  "max_tokens": 8192,
  "top_p": 1,
  "stream_options": {
    "include_usage": true
  }
}
[DEBUG] Request headers: {
  "host": "localhost:3000",
  "connection": "keep-alive",
  "content-length": "253",
  "sec-ch-ua-platform": "\"Windows\"",
  "authorization": "Bearer sk-V12m0OrJwrmA6XnI4yuFaEHinP10yvEbtpVL0xR0OYLq2v8I",
  "sec-ch-ua": "\"Not=A?Brand\";v=\"24\", \"Chromium\";v=\"140\"",
  "sec-ch-ua-mobile": "?0",
  "x-title": "Cherry Studio",
  "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) CherryStudio/1.7.13 Chrome/140.0.7339.249 Electron/38.7.0 Safari/537.36", 
  "http-referer": "https://cherry-ai.com",
  "content-type": "application/json",
  "accept": "*/*",
  "sec-fetch-site": "cross-site",
  "sec-fetch-mode": "cors",
  "sec-fetch-dest": "empty",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "zh-CN"
}
[DEBUG] Loading settings...
[DEBUG] Found 38 providers
[DEBUG] Providers: [
  {
    id: '1767452745627',
    name: 'OpenAI2',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767480985181',
    name: 'H800',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767483297959',
    name: '无言',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767501177111',
    name: '薄荷L3',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767508418970',
    name: '随跑',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767513326105',
    name: '随跑小站',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767579103174',
    name: '随跑副站',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767580467418',
    name: 'WONG公益',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767581306384',
    name: 'That API',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767581451534',
    name: 'ThatAPI 翻译',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767669857051',
    name: 'SWT公益',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767670126754',
    name: 'Ely',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767670470623',
    name: 'Huan API',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767679235660',
    name: 'HotaruAPI',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767679784432',
    name: '曼波公益',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767680008274',
    name: 'KFC公益',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767680243052',
    name: 'windhub',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767680511924',
    name: 'windhub free',
    apiType: 'openai',
    disabled: true
  },
  {
    id: '1767680591480',
    name: 'winhub-default',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767680911647',
    name: '小呆公益',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767681269134',
    name: 'NHH公益',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767681380418',
    name: '小随跑',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767681675308',
    name: '学渣',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767682209286',
    name: 'AI Wave Free',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767683097919',
    name: 'OpenAI',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767773407762',
    name: '扣腚API',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767838143843',
    name: '临时2',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767838414088',
    name: 'Free Duckcoding',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767838689229',
    name: 'Fengye',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1767838721984',
    name: 'fengye default',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1768029811120',
    name: '六哥公益',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1768032916208',
    name: 'XiaoYo',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1768201521312',
    name: '临时1',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1768201632669',
    name: '临时2',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1768205846542',
    name: 'Anyrouter',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1768206289952',
    name: '临时3',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1768209615427',
    name: 'omg',
    apiType: 'openai',
    disabled: false
  },
  {
    id: '1768256777496',
    name: 'Ely临时',
    apiType: 'openai',
    disabled: false
  }
]
[Fingerprint] Generated fingerprint for 2 messages: 549566b6...
[Session] Session ID: none
[Session] Message Fingerprint: 549566b6...
[Session] Using identifier: 549566b63104cab1...
[DEBUG] Model name determination:
[DEBUG] - Original model: gpt-oss-120b
[DEBUG] - Final model name: gpt-oss-120b
[DEBUG] Pure model name: gpt-oss-120b
[DEBUG] API key allowed models: [
  'gpt-4o-mini',
  'gpt-oss-120b',
  'claude-haiku-4-5-20251001',
  'claude-3-7-sonnet-20250219',
  'claude-sonnet-4-20250514',
  'claude-sonnet-4-5-20250929',
  'claude-opus-4-5-thinking',
  'claude-sonnet-4-5',
  'gemini-2.5-flash',
  'gemini-3-pro-low',
  'gemini-3-flash-preview',
  'gemini-3-pro-preview',
  'gpt-4.1-mini',
  'gpt-4.1-nano',
  'gpt-5-nano',
  'claude-sonnet-4-20250514-thinking',
  'claude-3-5-haiku-20241022',
  'deepseek-v3.1',
  'glm-4.6',
  'gpt-5',
  'deepseek-v3.2',
  'GLM-4.6',
  'GLM-4.7',
  'grok-3-fast',
  'grok-4-expert',
  'grok-4-fast',
  'grok-4.1',
  'claude-opus-4-5-20251101',
  'glm-4.5',
  'glm-4.5-air',
  'glm-4.7',
  'claude-4.5-opus',
  'claude-4.5-opus-2cc',
  'claude-4.5-sonnet',
  'claude-4.5-sonnet-2cc',
  'gemini-2.5-flash-lite',
  'gemini-2.5-pro',
  'kimi-k2',
  'deepseek-v3.1-terminus',
  'deepseek-v3.2-exp',
  'grok-4.1-thinking',
  'deepseek-v3.2-reasoner',
  'gemini-claude-sonnet-4-5-thinking',
  'zai-glm-4.6',
  'GLM-4.5-Air',
  'gpt-4o',
  'gemini-claude-opus-4-5-thinking',
  'DeepSeek-V3.1',
  'gemini-claude-sonnet-4-5',
  'claude-sonnet-4-5-thinking',
  'DeepSeek-V3.2',
  'gpt-4.1',
  'GLM-4.5V',
  'deepseek-chat',
  'gpt-5-mini',
  'GLM-4.5',
  'gpt-5.1',
  'gpt-5.2',
  'GLM-4.6V',
  'gpt-oss-120b-medium',
  'DeepSeek-R1-0528',
  'DeepSeek-V3.1-Terminus',
  'gpt-4.1-mini-2025-04-14',
  'gpt-4o-mini-2024-07-18'
]
[DEBUG] Available provider IDs for model gpt-oss-120b: [
  '1767480985181',
  '1767513326105',
  '1767669857051',
  '1767679235660',
  '1767680911647',
  '1767838721984'
]
[DEBUG] Excluded provider IDs for model gpt-oss-120b: []
[DEBUG] Actual available providers after exclusions: [
  '1767480985181',
  '1767513326105',
  '1767669857051',
  '1767679235660',
  '1767680911647',
  '1767838721984'
]
[Proxy] Request parameters - temperature: 0.4, max_tokens: 8192, top_p: 1
[Session] Using existing provider H800 for conversation gpt-oss-120b:549566b63104cab1f74c91b7f53d2721
[Session] Found existing provider binding: H800 (ID: 1767480985181)
[Failover] Getting failover providers for model: gpt-oss-120b
[Failover] Excluding providers: 1767480985181
[Failover] Available provider IDs for gpt-oss-120b: [
  '1767480985181',
  '1767513326105',
  '1767669857051',
  '1767679235660',
  '1767680911647',
  '1767838721984'
]
[Failover] Providers excluded from pool for gpt-oss-120b: []
[Failover] Added provider 随跑小站 (ID: 1767513326105) to failover list
[Failover] Added provider SWT公益 (ID: 1767669857051) to failover list
[Failover] Added provider HotaruAPI (ID: 1767679235660) to failover list
[Failover] Added provider 小呆公益 (ID: 1767680911647) to failover list
[Failover] Added provider fengye default (ID: 1767838721984) to failover list
[Failover] Provider 1767480985181 already tried, skipping
[Failover] Total failover providers: 5
[Proxy] Found 6 providers for failover
[Proxy] Attempt 1/6: Trying provider H800 (ID: 1767480985181)
[DEBUG] buildApiUrl called with:
[DEBUG] - baseUrl: https://api.agentify.top
[DEBUG] - endpoint: models
[DEBUG] - apiType: openai
[DEBUG] OpenAI compatible endpoint, final URL: https://api.agentify.top/v1/models
[Proxy] Using model ID: openai/gpt-oss-120b from provider H800
[DEBUG] Provider API type: openai
[DEBUG] buildApiUrl called with:
[DEBUG] - baseUrl: https://api.agentify.top
[DEBUG] - endpoint: chat/completions
[DEBUG] - apiType: openai
[DEBUG] OpenAI compatible endpoint, final URL: https://api.agentify.top/v1/chat/completions
[DEBUG] Starting streaming request to: https://api.agentify.top/v1/chat/completions
[DEBUG] buildChatRequestBody called with:
[DEBUG] - modelId: openai/gpt-oss-120b
[DEBUG] - apiType: openai
[DEBUG] - messages count: 2
[DEBUG] - params: {
  "temperature": 0.4,
  "max_tokens": 8192,
  "top_p": 1,
  "stream_options": {
    "include_usage": true
  }
}
[DEBUG] - images: none
[DEBUG] Building OpenAI compatible request body
[DEBUG] Final OpenAI request body: {
  "model": "openai/gpt-oss-120b",
  "messages": [
    {
      "role": "system",
      "content": "使用中午回复我"
    },
    {
      "role": "user",
      "content": "hello give me a jok in one sentence"
    }
  ],
  "temperature": 0.4,
  "max_tokens": 8192,
  "top_p": 1,
  "stream_options": {
    "include_usage": true
  }
}
[DEBUG] Request headers: {
  "Authorization": "Bearer sk-TJASgatrInEVH3FzaZcrXexrOzl4U1NEW514nyjNPE5MAQOV",
  "Content-Type": "application/json"
}
[DEBUG] Making streaming POST request...
[DEBUG] Stream request successful, response status: 200
[DEBUG] Response headers: {
  "alt-svc": "h3=\":443\"; ma=2592000",
  "content-length": "1351",
  "content-type": "application/json",
  "date": "Mon, 12 Jan 2026 23:16:50 GMT",
  "server": "uvicorn",
  "via": "1.1 Caddy",
  "x-oneapi-request-id": "20260113071742401687524seKGfmdE"
}
[DEBUG] Setting response headers for streaming...
[DEBUG] Original response Content-Type: application/json
[DEBUG] Response status set to: 200
[DEBUG] Response headers sent: false
[DEBUG] Starting to pipe response data...
[DEBUG] Client requested stream: true
[DEBUG] Stream request initiated successfully, exiting provider loop
[DEBUG] Received chunk 1: {"id":"chatcmpl-1b2d6e1e7d8d44febed4ef32b7c4d9b7","object":"chat.completion","created":1768259810,"model":"openai/gpt-oss-120b","choices":[{"index":0,"message":{"role":"assistant","content":"为什么程序员下雨天...
[DEBUG] Chunk length: 1351
[DEBUG] Headers sent before write: false
[DEBUG] Processing chunk with original Content-Type: application/json
[DEBUG] Processing JSON response, client expects stream: true
[DEBUG] Successfully parsed JSON response
[DEBUG] Returning complete JSON response directly
[DEBUG] Set Content-Type to application/json
[DEBUG] Sending JSON response with res.end(), length: 1205
[DEBUG] JSON data preview: {"id":"chatcmpl-1b2d6e1e7d8d44febed4ef32b7c4d9b7","object":"chat.completion","created":1768259810,"model":"openai/gpt-oss-120b","choices":[{"index":0,"message":{"role":"assistant","content":"为什么程序员下雨天...
[DEBUG] Response ended successfully with data using res.end()
[DEBUG] Response already completed in data handler, skipping end processing
[Failover] Updated polling state for gpt-oss-120b: nextIndex=1
[Session] Saved provider 1767480985181 for conversation gpt-oss-120b:549566b63104cab1f74c91b7f53d2721
[Session] Saved provider binding for session
Polling state saved successfully
[DEBUG] Background logging completed